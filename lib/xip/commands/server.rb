# frozen_string_literal: true

require 'rack/handler/puma'
require 'xip/commands/command'

module Xip
  module Commands
    class Server < Command
      def initialize(port:)
        @port = port
        $stdout.sync = true
      end

      def start
        # Rack::Handler::Puma.run(Xip::Server)
        puts ascii_art
        exec "foreman start -f Procfile.dev -p #{@port}"
      end

      private

        def ascii_art
          <<~ART
            \e[36m,,,,,,,,,,,\e[0m                                      \e[32m,,,,,,..,,,,,\e[0m
          \e[36m░░░░░░░░░░░░░░≥\e[0m                                  \e[32m╔╬╠╠╠╠╠╠╠╠╠╠╠╠╠⌐\e[0m
          \e[36m░░░░░░░░░░░░░░░░≥,\e[0m                             \e[32mé╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠⌐\e[0m
          \e[36m░░░░░░░░░░░░░░░░░░░,\e[0m                        \e[32m,@╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠⌐\e[0m
          \e[36m░░░░░░░░░░░░░░░░░░░░▒≥\e[0m                    \e[32m╓╬╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠⌐\e[0m
          \e[36m░░░░░░░░░░░░░░░░░░░░░░░≥\e[0m                \e[32m╓╬╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠⌐\e[0m
          \e[36m░░░░░░░░░░░░░░░░░░░░░░░░░≥\e[0m            \e[32m╔╬╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠⌐\e[0m
           \e[36m`╚░░░░░░░░░░░░░░░░░░░░░░░░≥,\e[0m       \e[32mé╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╜\e[0m
             \e[36m`╙░░░░░░░░░░░░░░░░░░░░░░░░\e[0m      \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╙\e[0m
                \e[36m%░░░░░░░░░░░░░░░░░░░░░░\e[0m      \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╬"\e[0m
                  \e[36m"░░░░░░░░░░░░░░░░░░░░\e[0m      \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╩\e[0m
                    \e[36m"░░░░░░░░░░░░░░░░░░\e[0m      \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╩²\e[0m
                      \e[36m`╚░░░░░░░░░░░░░░░\e[0m      \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╜\e[0m
                        \e[36m`╙░░░░░░░░░░░░░\e[0m      \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╙\e[0m


                        \e[32m╔φφφφφφφφφφφφφ\e[0m       \e[36m≥≥≥≥≥≥≥≥≥≥≥≥≥≥\e[0m
                       \e[32m╔╬╠╠╠╠╠╠╠╠╠╠╠╠╠╠\e[0m      \e[36m░░░░░░░░░░░░░░░≥\e[0m
                    \e[32m,#╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠\e[0m      \e[36m░░░░░░░░░░░░░░░░░≥\e[0m
                  \e[32m,ê╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠\e[0m      \e[36m░░░░░░░░░░░░░░░░░░░≥,\e[0m
                \e[32m²╬╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠\e[0m      \e[36m░░░░░░░░░░░░░░░░░░░░░░,\e[0m
              \e[32m╔╬╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠\e[0m      \e[36m░░░░░░░░░░░░░░░░░░░░░░░▒≥\e[0m
            \e[32m╔╬╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╩\e[0m      \e[36m"░░░░░░░░░░░░░░░░░░░░░░░░░≥\e[0m
          \e[32m#╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╜ \e[0m         \e[36m"░░░░░░░░░░░░░░░░░░░░░░░░░≥\e[0m
          \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╙ \e[0m             \e[36m`≥░░░░░░░░░░░░░░░░░░░░░░░\e[0m
          \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╩" \e[0m                  \e[36m░░░░░░░░░░░░░░░░░░░░░░\e[0m
          \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╩ \e[0m                       \e[36m²░░░░░░░░░░░░░░░░░░░\e[0m
          \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╩ \e[0m                           \e[36m"░░░░░░░░░░░░░░░░░\e[0m
          \e[32m╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╜ \e[0m                               \e[36m"░░░░░░░░░░░░░░░\e[0m
          \e[32m╚╚╚╚╚╩╩╩╩╩╩╩╩╙ \e[0m                                   \e[36m`============²\e[0m



                                Xip v#{Xip::VERSION}

          ART
        end
    end
  end
end
